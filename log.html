<html>
<head>
<script type="text/javascript" src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript">

var running = false;
function send()
{
	if(running==true)
		return 
	running = true;
	alert("in");
	$.ajax({url:"tail?"+$('#name').val(),async:true,dataType: "json",
		complete: function(xmlhttp, textStatus){//complete不管是success还是fail都会执行
			if(textStatus!="success")
				return ;
			var obj = eval("("+xmlhttp.responseText+")");//obj是根据返回的json进行解包得到的对象
			if(obj.hasOwnProperty('lines'))//检查是否只有lines这么一个属性
			{	
				var cnt = 0;
				for (x in obj)
					cnt++;
				if(cnt!=1)
					return;
			}
			else
			{
				return ;
			}
			var out = "";
			for(i=0;i<obj.lines.length;i++)
				out+=obj.lines[i]+"<br/>";
			$("#myDiv").html(out);
        }
	});
	running = false;
}
$(document).ready(function()
{
	$("#sendBtn").click(function()
	{
		setInterval("send()",1000);
	});
});
</script>
</head>
<body>

<input id="name" type="text"/>
<input type="button" id="sendBtn" value="send"/>
<div id="myDiv"><h2>通过 AJAX 改变文本</h2></div>
</body>
</html>
